package org.opentestsystem.delivery.logging;

import javax.servlet.http.HttpServletRequest;
import java.util.Map;

public abstract class EventParserFactory {

  /**
   * Implement this to provide the map of PATHINFO to EventParser Classes.
   *
   * @return
   */
  protected abstract Map<String, Class<? extends EventParser>> getEventParserClassMap();

  /**
   * Returns an EventParser for the current request, as discovered via request.getPathInfo().
   * Used by logging interceptor to pull data out of the request and response for event logging.
   *
   * @param request
   * @return
   * @throws IllegalAccessException
   * @throws InstantiationException
   */
  public EventParser get(HttpServletRequest request) throws IllegalAccessException, InstantiationException {
    if (getEventParserClassMap().containsKey(request.getPathInfo())) {
      return getEventParserClassMap().get(request.getPathInfo()).newInstance();
    }
    return new EventParser();
  }

}
